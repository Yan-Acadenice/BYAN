---
# ProjectContext - update-byan-agent
# Generated by BYAN Interview
# Date: 2026-02-02T23:38:00Z

project_name: "update-byan-agent"
description: "CLI npm pour gérer mises à jour BYAN avec détection conflits intelligente et préservation customisations"
domain: "DevOps / Version Management"
subdomain: "BYAN Ecosystem"

maturity_level: "mvp"
release_frequency: "daily_multiple"

stack_tech:
  backend:
    - "Node.js 18+"
  cli:
    - "npm"
    - "npx"
  libraries:
    - "diff"
    - "inquirer"
    - "chalk"
    - "ora"
    - "commander"
    - "fs-extra"
    - "js-yaml"
  infrastructure:
    - "npm registry"
  constraints:
    - "Compatible avec create-byan-agent existant"
    - "Zéro dépendance sur Git (optionnel)"

team:
  size: "multi-user"
  skills:
    - "Junior developers"
    - "Intermediate developers"
    - "Senior developers"
  methodology: "Agile / Continuous Delivery"

pain_points:
  - point: "Préserver customisations utilisateur lors updates BYAN"
    frequency: "haute"
    impact: "critique"
  - point: "Validation conformité 10+ ans best practices"
    frequency: "haute"
    impact: "haute"
  - point: "Pas de confiance dans Git standard (Zero Trust)"
    frequency: "moyenne"
    impact: "haute"

root_cause: "Absence de système merge intelligent aware de la structure BYAN (frontmatter + XML + mantras)"

goals:
  - "Zéro perte de customisations utilisateur"
  - "100% validation conformité règles BYAN"
  - "Processus update cadré et stable"
  - "Interface accessible tous niveaux (junior→senior)"

success_criteria:
  - "100% customisations préservées"
  - "0 erreur structure BYAN post-merge"
  - "Temps update < 2 minutes (sans conflits)"
  - "Adoption équipe > 80%"

glossaire:
  version:
    definition: "Différence entre installation utilisateur actuelle et dernière version BYAN publiée, particulièrement les changements destructifs (suppression/écrasement)"
    synonyms: ["release", "version publiée"]
    examples:
      - "1.0.5 (stable)"
      - "1.0.6-beta.1 (pre-release)"
    attributes:
      creation: "npm publish + git push (simultanés)"
      format: "Semver (major.minor.patch)"
      focus: "Changements destructifs"
  
  customisation:
    definition: "Toute modification ou création par l'utilisateur dans l'installation BYAN (agents, workflows, config)"
    synonyms: ["personnalisation", "modification user"]
    types:
      - "agent_modifie: Agent core BYAN modifié par user"
      - "agent_cree: Nouvel agent créé par user"
      - "config_modifie: config.yaml personnalisé"
      - "workflow_modifie: Workflow BYAN modifié"
      - "workflow_cree: Nouveau workflow user"
    detection:
      - "Metadata dans frontmatter (author, created_by)"
      - "Hash SHA du fichier vs original"
      - "Historique git (commits user vs commits Yan)"
    priority: "CRITIQUE - Ne jamais écraser"
  
  conflit:
    definition: "Situation où version BYAN et customisation user modifient le même fichier ou section"
    examples:
      - "User a modifié byan.md ligne 50, nouvelle version modifie aussi ligne 50"
      - "User a config.yaml avec champ X, nouvelle version supprime champ X"
    resolution: "Agent détecte, analyse, propose stratégies avec justifications"
  
  backup:
    definition: "Copie de sauvegarde complète avant toute modification destructive"
    format: "_bmad-backup-{timestamp}/"
    contenu: "Snapshot complet de l'installation actuelle avec metadata"
    attributes:
      automatique: true
      horodatage: "ISO 8601"
      metadata: "Version actuelle, date, user"
  
  strategie_merge:
    definition: "Règles et méthodes pour résoudre conflits lors de l'update"
    options:
      keep_user: "Garder version utilisateur (priorité customisation)"
      keep_byan: "Garder version BYAN (priorité update)"
      merge_intelligent: "Fusionner les deux (complexe)"
      ask_user: "Demander décision utilisateur (interactif)"
    default: "keep_user (Zero Trust - préserver user)"
    application: "Mantra IA-1 (Trust But Verify) + IA-16 (Challenge Before Confirm)"
  
  migration:
    definition: "Changement de structure BYAN entre versions majeures (ex: v1→v2 format différent)"
    criticite: "Haute - peut casser compatibilité"
    examples:
      - "config.yaml → config.json"
      - "Frontmatter v1 → Frontmatter v2"
    requirements:
      - "Backup critique obligatoire"
      - "Validation post-migration"
      - "Rollback disponible"
  
  validation:
    definition: "Vérification de conformité aux règles BYAN (structure + mantras) avant et après merge"
    quand:
      - "Avant merge (pré-validation)"
      - "Après merge (post-validation)"
    controles:
      - "Structure: frontmatter YAML valide"
      - "Structure: XML bien formé"
      - "Activation: étapes 1-7 présentes"
      - "Mantras: IA-23 (no emoji), IA-24 (clean code)"
  
  rapport_diff:
    definition: "Document détaillé des changements détectés entre versions"
    contenu:
      - "fichiers_ajoutes: Nouveaux fichiers dans version BYAN"
      - "fichiers_supprimes: Fichiers supprimés dans nouvelle version"
      - "fichiers_modifies: Fichiers existants modifiés"
      - "conflits: Liste des conflits détectés avec customisations"
    format: "Markdown structuré + tableaux visuels"
    audience: "Tous niveaux (junior→senior)"
  
  installation_source:
    definition: "Origine de l'installation BYAN"
    types:
      npm: "Installation via npx create-byan-agent"
      git_clone: "Clone direct du repository"
      manual: "Installation manuelle (fichiers copiés)"
    impact: "Stratégie update différente selon source"

acteurs:
  - name: "Yan (Mainteneur)"
    type: "internal"
    role: "Créateur et mainteneur BYAN"
    permissions:
      - "Publier nouvelles versions"
      - "Définir règles de validation"
      - "Tester migrations"
    description: "Développe BYAN, publie plusieurs fois par jour"
  
  - name: "Utilisateur Junior"
    type: "external"
    role: "Développeur débutant utilisant BYAN"
    permissions:
      - "Installer BYAN"
      - "Créer agents custom"
      - "Modifier config"
    needs:
      - "Interface simple et guidée"
      - "Explications pédagogiques"
      - "Prévention erreurs"
  
  - name: "Utilisateur Intermédiaire"
    type: "external"
    role: "Développeur utilisant BYAN régulièrement"
    permissions:
      - "Modifier agents core"
      - "Créer workflows custom"
      - "Gérer conflits simples"
    needs:
      - "Rapports détaillés"
      - "Options avancées disponibles"
  
  - name: "Utilisateur Senior"
    type: "external"
    role: "Expert BYAN, contributeur potentiel"
    permissions:
      - "Merge manuel complexe"
      - "Validation avancée"
      - "Debug structure BYAN"
    needs:
      - "Contrôle total"
      - "Mode expert/verbose"
      - "Accès bas niveau"

processus_metier:
  - name: "Installation initiale BYAN"
    description: "Utilisateur installe BYAN via npx create-byan-agent"
    steps:
      - "Exécution npx create-byan-agent"
      - "Sélection options (language, modules)"
      - "Création structure _bmad/"
      - "Installation agents, workflows, config"
    criticity: "high"
  
  - name: "Customisation par utilisateur"
    description: "Utilisateur personnalise son installation BYAN"
    steps:
      - "Création agents custom dans _bmad-output/bmb-creations/"
      - "Modification agents core (optional)"
      - "Modification config.yaml"
      - "Ajout workflows custom"
    criticity: "medium"
  
  - name: "Publication nouvelle version BYAN"
    description: "Yan publie nouvelle version sur npm"
    steps:
      - "Développement features/fixes"
      - "Tests validation"
      - "npm version patch/minor/major"
      - "npm publish + git push + git tag"
    criticity: "critical"
    frequency: "Plusieurs fois par jour"
  
  - name: "Update utilisateur (processus cible)"
    description: "Utilisateur met à jour son installation BYAN"
    steps:
      - "Exécution npx update-byan-agent"
      - "Détection version actuelle vs latest"
      - "Backup automatique"
      - "Analyse customisations"
      - "Détection conflits"
      - "Proposition stratégies"
      - "Confirmation utilisateur"
      - "Application merge"
      - "Validation post-merge"
      - "Rapport final"
    criticity: "critical"
    success_criteria:
      - "0 perte customisation"
      - "0 erreur structure"
      - "< 2 min sans conflits"
  
  - name: "Rollback"
    description: "Utilisateur revient à version précédente"
    steps:
      - "Exécution npx update-byan-agent rollback"
      - "Liste backups disponibles"
      - "Sélection backup"
      - "Confirmation"
      - "Restauration complète"
      - "Validation"
    criticity: "high"

regles_gestion:
  - id: "RG-UPD-001"
    description: "Backup automatique obligatoire avant toute modification"
    priority: "critical"
    regulatory: false
    mantra: "Mantra IA-1 (Trust But Verify)"
  
  - id: "RG-UPD-002"
    description: "Customisations utilisateur ne doivent JAMAIS être écrasées sans confirmation explicite"
    priority: "critical"
    regulatory: false
    mantra: "Mantra IA-16 (Challenge Before Confirm)"
  
  - id: "RG-UPD-003"
    description: "Validation structure BYAN obligatoire post-merge (frontmatter + XML + activation)"
    priority: "critical"
    regulatory: false
    mantra: "Mantra #4 (Fail Fast, Fail Visible)"
  
  - id: "RG-UPD-004"
    description: "Rapport détaillé généré pour chaque update, accessible à tous niveaux"
    priority: "high"
    regulatory: false
  
  - id: "RG-UPD-005"
    description: "Évaluation conséquences 10 dimensions avant action destructive"
    priority: "critical"
    regulatory: false
    mantra: "Mantra #39 (Évaluer Conséquences)"
    dimensions:
      - "Scope (périmètre impacté)"
      - "Data (données affectées)"
      - "Code (fichiers modifiés)"
      - "Team (équipe affectée)"
      - "Users (utilisateurs impactés)"
      - "Rollback (possibilité retour)"
      - "Dependencies (dépendances cassées)"
      - "Time (temps nécessaire)"
      - "Risk (niveau risque)"
      - "Alternatives (autres options)"

edge_cases:
  - scenario: "Installation BYAN modifiée manuellement hors structure standard"
    risque: "Détection customisations peut échouer"
    mitigation: "Demander confirmation avant toute modification, même non-détectée"
  
  - scenario: "Conflit sur fichier binaire (si présent)"
    risque: "Diff textuel impossible"
    mitigation: "Stratégie: keep_user par défaut, signaler impossibilité merge"
  
  - scenario: "Migration majeure (v1→v2) avec structure incompatible"
    risque: "Rollback peut être impossible"
    mitigation: "Backup critique + validation extensive + documentation migration"
  
  - scenario: "Utilisateur a cassé structure BYAN (YAML invalide, XML mal formé)"
    risque: "Update peut aggraver situation"
    mitigation: "Pré-validation obligatoire, refuser update si structure invalide, proposer réparation"
  
  - scenario: "Multiple backups accumulés (espace disque)"
    risque: "Consommation espace disque"
    mitigation: "Politique rétention configurable, cleanup automatique (garder N derniers)"

metadata:
  version: "1.0.0"
  created_by: "BYAN Interview"
  created_at: "2026-02-02T23:38:00Z"
  interview_duration: "35 minutes"
  validation_status: "validated"
  mantras_applied:
    - "IA-1: Trust But Verify"
    - "IA-16: Challenge Before Confirm"
    - "#33: Data Dictionary First"
    - "#39: Évaluer Conséquences"
